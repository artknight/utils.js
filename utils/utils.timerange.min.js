UTILS.Timerange=class extends UTILS.Base{init(data){if(this.parent(data),_log(this.getObjectName()+" --\x3e instantiated!",this.getId(),this),!("target"in data))throw new Error("@target must be specified upon initialization!");return _.isPlainObject(data)&&("options"in data&&this.setOptions(data.options),"range"in data&&this.setRange(data.range),"date_editable"in data&&this.setDateEditableState(data.date_editable),"date_format"in data&&this.setDateFormat(data.date_format),"allow_past_dates"in data&&this.setAllowPassedDates(data.allow_past_dates),"date"in data&&this.setDate(data.date),"onShow"in data&&this.addCallback("onShow",data.onShow),"onHide"in data&&this.addCallback("onHide",data.onHide),"onStart"in data&&this.addCallback("onStart",data.onStart),"onStop"in data&&this.addCallback("onStop",data.onStop),"onSlide"in data&&this.addCallback("onSlide",data.onSlide)),this._initSlider(),this}getDefaults(){return{object:"utils.timerange",version:"0.0.7",$wrapper:null,is_shown:!1,date:moment(),is_date_editable:!0,date_format:"MM/DD/YYYY",allow_past_dates:!1,EditableDate:null,range:{start:540,end:1020},settings:{range:!0,min:0,max:1440,step:15}}}clean(){return this.values.$wrapper.remove(),this}_create(){return this.values.$wrapper||(this.values.$wrapper=$('<div class="app-timerange hide"><div class="slider-header"><div class="slider-header-date">Date: <span></span></div><div class="slider-header-timerange">Time: <span class="slider-start"></span> - <span class="slider-end"></span></div></div><div class="slider-range"></div></div>'),this.values.$wrapper.data("$timerange",this)),this.values.$wrapper}enable(){var $slider=this.getWrapper().find(".slider-range"),EditableDate=this._getEditableDate();return $slider.labeledslider("enable"),EditableDate&&EditableDate.enable(),this}disable(){var $slider=this.getWrapper().find(".slider-range"),EditableDate=this._getEditableDate();return $slider.labeledslider("disable"),EditableDate&&EditableDate.disable(),this}isShown(){return this.values.is_shown}isDateEditable(){return this.values.is_date_editable}setDateEditableState(state){return this.values.is_date_editable=!!state,this}getDate(){return this.values.date}setDate(date){var date_format=this.getDateFormat();return _.isString(date)?this.values.date=moment(date,date_format):moment.isMoment(date)?this.values.date=date:this.values.date=moment(),this.updateDateDisplay(),this}isAllowPassedDates(){return this.values.allow_past_dates}setAllowPassedDates(state){return this.values.allow_past_dates=!!state,this}getDateFormat(){return this.values.date_format}setDateFormat(format){return this.values.date_format=format,this}getWrapper(){return this.values.$wrapper}_formatDisplayTime(total_mins){var hrs=Math.floor(total_mins/60),mins=total_mins-60*hrs;return 1===hrs.length&&(hrs="0"+hrs),1===mins.length&&(mins="0"+mins),0==mins&&(mins="00"),hrs>=12?12==hrs?mins+=" PM":24==hrs?(hrs=11,mins="59 PM"):(hrs-=12,mins+=" PM"):mins+=" AM",0==hrs&&(hrs=12),hrs+":"+mins}_getEditableDate(){return this.values.EditableDate}_setEditableDate(EditableDate){return this.values.EditableDate=EditableDate,this}updateDateDisplay(){var date=this.getDate(),date_format=this.getDateFormat(),is_date_editable=this.isDateEditable(),allow_passed_dates=this.isAllowPassedDates(),$slider_date=this.getWrapper().find(".slider-header-date span");if(is_date_editable){var EditableDate=this._getEditableDate();if(!EditableDate){var editable_options={target:$slider_date,type:"date",date_options:{format:date_format,startDate:allow_passed_dates?0:"+0d"},value:date.format(date_format),onAfterSave:function(Editable){this.setDate(Editable.getValue()),this._fns("onStop")}.bind(this)};EditableDate=new APP.Editable(editable_options).enable(),this._setEditableDate(EditableDate)}}else $slider_date.html(date.format(date_format));return this}updateTimeDisplay(){var range=this.getTimeRange(),$wrapper=this.getWrapper(),$start=$wrapper.find(".slider-start"),$end=$wrapper.find(".slider-end");return $start.html(this._formatDisplayTime(range.start)),$end.html(this._formatDisplayTime(range.end)),this}setTarget(target){return this.parent(target),this.values.$target.append(this._create()),this}_initSlider(){var $wrapper=this.getWrapper(),range=this.getTimeRange(),$slider=$wrapper.find(".slider-range");return this.setOptions({slide:this._onSlide,start:this._onStart,stop:this._onStop,values:[range.start,range.end],tickInterval:60,tickLabels:function(interval){var hrs=Math.floor(interval/60),a="PM";return hrs>=12?24===hrs?hrs=12:hrs-=12:a="AM",0===hrs&&(hrs=12),hrs+" "+a}}),$slider.labeledslider(this.getOptions()),this}getOptions(){return this.values.settings}setOptions(options){return _.isPlainObject(options)&&_.extend(this.values.settings,options),this.values.settings}getTimeRange(){return this.values.range}getFormattedTimeRange(){var range=this.getTimeRange();return{start:this._formatDisplayTime(range.start),end:this._formatDisplayTime(range.end)}}getDateTimeRange(){return _.assign({},this.values.range,{date:this.getDate()})}getFormattedDateTimeRange(){var formatted_range=this.getFormattedTimeRange(),date=this.getDate(),date_format=this.getDateFormat();return _.assign({},formatted_range,{date:date.format(date_format)})}_getHoursMinsFromTotalMins(total_mins){return{hrs:Math.floor(total_mins/60),mins:total_mins%60}}getDateTimeRangeAsMoment(){var range=this.getTimeRange(),range_start=this._getHoursMinsFromTotalMins(range.start),range_end=this._getHoursMinsFromTotalMins(range.end),date=this.getDate();return{start:date.clone().hours(range_start.hrs).minutes(range_start.mins).seconds(0),end:date.clone().hours(range_end.hrs).minutes(range_end.mins).seconds(0)}}_normalizeMinutes(mins){var options=this.getOptions();return mins&&(mins=options.step*Math.ceil(mins/options.step))>options.max&&(mins=options.max),mins}setRange(range){return _.isPlainObject(range)&&("start"in range&&(range.start=this._normalizeMinutes(range.start)),"end"in range&&(range.end=this._normalizeMinutes(range.end)),_.extend(this.values.range,range)),this}show(){var $wrapper=this.getWrapper();return this.updateTimeDisplay(),$wrapper.removeClass("hide"),this._fns("onShow"),this.values.is_shown=!0,this}hide(){var $wrapper=this.getWrapper();return this._fns("onHide"),$wrapper.addClass("hide"),this.values.is_shown=!1,this}_onSlide(event,ui){var mins1=ui.values[0],mins2=ui.values[1];this.setRange({start:mins1,end:mins2}),this.updateTimeDisplay(),this._fns("onSlide")}_onStart(event,ui){this._fns("onStart")}_onStop(event,ui){this._fns("onStop")}},"undefined"!=typeof module&&module.hasOwnProperty("exports")&&(module.exports=UTILS.Timerange);