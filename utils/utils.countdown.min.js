UTILS.Countdown=class extends UTILS.Base{constructor(data){return super(data),_.isPlainObject(data)&&("onTick"in data&&this.addCallback("onTick",data.onTick),"onStart"in data&&this.addCallback("onStart",data.onStart),"onStop"in data&&this.addCallback("onStop",data.onStop),"duration"in data&&this.setDuration(data.duration),"granularity"in data&&this.setGranularity(data.granularity),"color"in data&&this.setColor(data.color),"format"in data&&this.setFormat(data.format)),this.getColor()||this.setColor("black"),this}getDefaults(){return{object:"utils.countdown",version:"0.0.2",$elm:null,divs:{},is_shown:!1,is_running:!1,colors:[{name:"standalone",css:"timer-countdown-standalone"},{name:"white",css:"timer-countdown-white"},{name:"gray",css:"timer-countdown-gray"},{name:"red",css:"timer-countdown-red"},{name:"black",css:"timer-countdown-black"},{name:"green",css:"timer-countdown-green"}],color:null,duration:0,granularity:1e3,format:"h [h] m [m] s [s]",timer:null}}clean(){return this.values.$elm.remove(),this}start(){if(!this.isRunning()){this.values.is_running=!0,this.fns("onStart");var start=moment(),duration=this.getDuration(),remaining=duration,granularity=this.getGranularity(),format=this.getFormat(),time="",_runningTimer=function(){(remaining=duration-moment().diff(start,"seconds"))>0?this.values.timer=setTimeout(_runningTimer,granularity):(remaining=0,this.stop()),time=moment.duration(remaining,"seconds").format(format),this.updateTimer(time),this.fns("onTick",{time:time})}.bind(this);_runningTimer()}return this}stop(){return this.resetTimer(),this.fns("onStop"),this}resetTimer(){return this.values.is_running=!1,clearTimeout(this.values.timer),this}reStart(){return this.isRunning()&&this.resetTimer(),this.start(),this}isRunning(){return this.values.is_running}_create(){return this.values.$elm||(this.values.$elm=$('<span class="timer-countdown"></span>')),this.values.$elm}getTimer(){return this.values.$elm}updateTimer(time){this.values.$elm.text(time)}setTarget(target){return super.setTarget(target),this.values.$target.append(this._create()),this}getFormat(){return this.values.format}setFormat(format){return this.values.format=format,this}getDuration(){return this.values.duration}setDuration(duration){return this.values.duration=duration,this.reStart(),this}getGranularity(){return this.values.granularity}setGranularity(granularity){return this.values.granularity=granularity,this}getColor(){return this.values.color}setColor(color){var $timer=this.getTimer();this.values.color=_.find(this.values.colors,{name:color});var classes=$timer.attr("class").match(/(?:^|)timer-countdown-(\w+)(?!\w)/g)||[];return classes.length&&$timer.removeClass(_.joinArray(classes," ")),$timer.addClass(this.values.color.css),this}};