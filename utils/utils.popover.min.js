UTILS.Popover=class extends UTILS.Base{constructor(data={}){return super(data),"title"in data&&this.setTitle(data.title),"options"in data&&this.setOptions(data.options),"direction"in data&&this.setDirection(data.direction),"blur"in data&&this.setBlurState(data.blur),"width"in data&&this.setWidth(data.width),"hide_on_click"in data&&this.setHideOnClickState(data.hide_on_click),"toggle"in data&&this.setToggleAction(data.toggle),"template"in data&&this.setTemplate(data.template),"container"in data&&this.setContainer(data.container),"content"in data&&this.setContent(data.content),"items"in data&&this.setItems(data.items),"css"in data&&this.setTemplateCss(data.css),"onSelect"in data&&this.addCallback("onSelect",data.onSelect),"onBeforeShow"in data&&this.addCallback("onBeforeShow",data.onBeforeShow),"onShow"in data&&this.addCallback("onShow",data.onShow),"onHide"in data&&this.addCallback("onHide",data.onHide),"onCancel"in data&&this.addCallback("onCancel",data.onCancel),"container"in data||this.setContainer($("body")),this}getDefaults(){return{object:"utils.popover",version:"0.1.9",items:[],$content:"",title:"",options:{},direction:"bottom",$container:null,is_enabled:!1,__popover:null,Blur:null,is_blur:!1,hide_on_click:!0,is_shown:!1,toggle_action:"click",width:null,$template:$('<div class="popover popover-custom" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>')}}getPopoverElmContainer(){return $(this.getPopoverElm().tip)}getWidth(){return this.values.width}setWidth(width=300){return this.values.width=parseInt(width),this}getTemplate(){return this.values.$template}setTemplate(template){return this.values.$template=$(template),this}setTemplateCss(css){return css&&this.getTemplate().addClass(css),this}getOptions(){return this.values.options}setOptions(options){return _.extend(this.values.options,options),this}setTarget(target){return target?super.setTarget(target):this.values.$target=null,this}enable(){if(!this.values.is_enabled){var $target=this.getTarget(),toggle_action=this.getToggleAction(),title=this.getTitle(),$template=this.getTemplate(),width=this.getWidth(),options=this.getOptions();if($target){width&&$template.css({width:width,"max-width":width});var default_options={html:!0,content:this.getContent.bind(this),placement:$(window).width()>768?this.getDirection():"bottom",container:this.getContainer(),trigger:"dblclick"==toggle_action?"manual":toggle_action,template:$template.prop("outerHTML")};title.length&&(default_options.title=title),_.extend(default_options,options),$target.popover(default_options).on("shown.bs.popover",this._onShow.bind(this)).on("hide.bs.popover",this._onHide.bind(this)),"dblclick"==toggle_action&&$target.popover().on("dblclick",function(){$target.popover("show")}),$target.is("a")&&$target.on(toggle_action,function(event){event.preventDefault()}),this.setPopoverElm($target.data("bs.popover")),$target.data("$utils.popover",this),this.getHideOnClick()&&$(document).on("click",this.hideOnOutsideClick.bind(this)),this.values.is_enabled=!0}else UTILS.Errors.show("@target must be specified.")}return this}disable(){return this.values.is_enabled&&(this.getTarget().popover("destroy"),$(document).off("click",this.hideOnOutsideClick.bind(this)),this.values.is_enabled=!1),this}getToggleAction(){return this.values.toggle_action}setToggleAction(toggle_action){return toggle_action&&(this.values.toggle_action=toggle_action),this}setHideOnClickState(state){this.values.hide_on_click=toBoolean(state)}getHideOnClick(){return this.values.hide_on_click}isBlur(){return this.values.is_blur}setBlurState(state){this.values.is_blur=toBoolean(state)}getBlur(){return this.values.Blur}setBlur(){return this.isBlur()&&(this.values.Blur?this.values.Blur.setTarget(this.getContainer()):this.values.Blur=new UTILS.Blur({target:this.getContainer(),color:"white"})),this}getPopoverElm(){return this.values.__popover}setPopoverElm(__popover){return this.values.__popover=__popover,this}_onShow(){return this.values.is_shown||(this.isBlur()&&this.getBlur().show(),this.fns("onShow"),this.values.is_shown=!0),this}_onHide(){return this.isBlur()&&this.getBlur().hide(),this.fns("onHide"),this}hide(){return this.values.is_shown&&(this._onHide(),this.getTarget().popover("hide"),this.values.is_shown=!1),this}hideOnOutsideClick(event){_.each($("[data-original-title]"),function(popover){var $popover=$(popover);$popover.is(event.target)||$popover.has(event.target).length||$(".popover").has(event.target).length||(this.hide(),this.fns("onCancel"))}.bind(this))}getContainer(){return this.values.$container}setContainer(container){return this.values.$container=$(container),this.setBlur(),this}getDirection(){return this.values.direction}setDirection(direction){return this.values.direction=direction,this}getTitle(){return this.values.title}setTitle(title){var $target=this.getTarget();return this.values.title=title,$target.length&&$target.attr("data-original-title",title),this}getItems(){return this.values.items}setItems(items){return this.values.items=items,this.populate(),this}getContent(){return this.values.$content}setContent(content){return this.values.$content=$(content),this.onContentChanged(),this}onContentChanged(){if(this.values.is_shown){let __popover=this.getPopoverElm(),$tip=$(__popover.tip);__popover.setContent(),$tip.addClass(__popover.config.placement),$tip.is(":visible")&&__popover.show()}}populate(){var $content=$('<div class="list-group"></div>');return _.each(this.getItems(),function(item){var $item=$('<a class="list-group-item cursor '+("css"in item?item.css:"")+'"><span>'+item.label+"</span></a>").data("popover-selected-item",item).on("click",function(event){this.fns("onSelect",$(event.currentTarget).data("popover-selected-item")||$(event.target).parent().data("popover-selected-item")),this.hide()}.bind(this));"icon"in item&&$item.prepend('<i class="list-group-item-icon '+item.icon+'"></i>'),"color"in item&&$item.css("color",item.color),$content.append($item)}.bind(this)),this.setContent($content),this}};