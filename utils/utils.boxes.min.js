APP.Box=class extends UTILS.Box{constructor(data){if("object"in data||(data.object="utils.box[app.box]"),super(data),"mapper"in data){this.values.mapper=APP.members.getMapper(data.mapper);for(var box,title="",stacked_boxes=APP.stack.getBoxes(),i=0;box=stacked_boxes[i];i++){var lnk=i<stacked_boxes.length-1?'<span class="label label-primary"><a href="javascript:;" onclick="APP.stack.resetDepth('+(i+1)+');return false;">'+box.values.mapper.single+"</a></span>":'<span class="label label-default">'+this.values.mapper.single+"</span>";title+=(i?" &raquo; ":"")+lnk}this.set({title:title})}return this}create(){return super.create(),APP.stack.addBox(this),this}fns(type){type&&(/^onBeforeStart$/i.test(type)&&APP.stack.blurLastBox(this),/^onClose$/i.test(type)&&(APP.stack.unblurLastBox(this),APP.stack.removeBox(this))),super.fns(type)}},APP.Confirm=class extends APP.Box{constructor(data){return"object"in data||(data.object="utils.box[app.confirm]"),super(_.extend({w:400,title:"",html:"<p>Do you want to proceed?</p>",dd:!1,classname:"box-confirm",center:!0},data)),"onConfirm"in data&&(this.addCallback("onConfirm",data.onConfirm),this.values.divs.$inner_controls=$('<div class="regular text-right">'),this.values.divs.$confirm=$('<button type="button" class="btn btn-danger">proceed</button>'),this.values.divs.$cancel=$('<button type="button" class="btn btn-light">cancel</button>'),this.values.divs.$inner_controls.append(this.values.divs.$cancel,this.values.divs.$confirm),this.values.divs.$mainbody.append(this.values.divs.$inner_controls),this.values.divs.$confirm.on("click.confirm.utils.box",function(event){event.preventDefault(),event.stopPropagation(),this.clean("confirm").fns("onConfirm")}.bind(this)),"onCancel"in data?(this.addCallback("onCancel",data.onCancel),this.values.divs.$cancel.on("click.clean.utils.box",function(event){event.preventDefault(),event.stopPropagation(),this.clean("clean").fns("onCancel")}.bind(this))):this.values.divs.$cancel.on("click.clean.utils.box",function(event){event.preventDefault(),event.stopPropagation(),this.clean()}.bind(this))),"customButtons"in data&&("confirm"in data.customButtons&&this.values.divs.$confirm.html(data.customButtons.confirm),"cancel"in data.customButtons&&this.values.divs.$cancel.html(data.customButtons.cancel)),this}clean(action){return super.clean(),(!action||action&&!/clean|confirm/.test(action))&&this.fns("onCancel"),this}};var alert_boxes={error:[],success:[],info:[],warning:[]};APP.Alert=class extends UTILS.Box{constructor(data){"type"in data||(data.type="info"),"object"in data||(data.object="utils.box[app.alert]");var defaults={w:600,title:"",html:"",dd:!1,light:!0,buttons:{close:!0,maximize:!1}},custom={error:{w:600,classname:"box-red",html:$('<span><i class="mdi mdi-alert mdi-24px"></i></span>'),fx:{effect:"expand-in"}},success:{w:400,classname:"box-green",html:$('<span><i class="mdi mdi-check mdi-24px"></i></span>'),fx:{effect:"slide-up"}},info:{w:400,classname:"box-blue",html:$('<span><i class="mdi mdi-info mdi-24px"></i></span>'),fx:{effect:"slide-right"}},warning:{w:400,classname:"box-yellow",html:$('<span><i class="mdi mdi-exclamation mdi-24px"></i></span>'),fx:{effect:"expand-in"}}};/error/.test(data.type)&&"classname"in data&&/soft/.test(data.classname)&&(custom[data.type].html=$('<span><h4><i class="mdi mdi-alert mdi-24px"></i> Oops...</h4></span>')),custom[data.type].html.append(" ").append(data.html||"");defaults=_.extend(defaults,custom[data.type]);return delete data.html,"classname"in data&&(defaults.classname+=" "+data.classname,delete data.classname),super(_.extend(defaults,data)),this.setBoxType(data.type),/error|warning/.test(data.type)?(this.getBox().on("click",this.clean.bind(this)),this.set({center:!0})):this.set({classname:"alert-box",onShow:function(box){box.clean.bind(box).delay(1e3)}}),alert_boxes[data.type].push(this),this}isSmallViewPort(){return!!($(window).width()<this.values.$elm.outerWidth()+10)}getBoxType(){return this.values.type}setBoxType(type){return this.values.type=type,this}adjustCoords(){var $last_box=$(".alert-box:not(.box-red)").last(),is_small_viewport=this.isSmallViewPort();is_small_viewport&&this.set({w:$(window).width()-20});var coords={left:is_small_viewport?10:$(window).width()-this.values.$elm.outerWidth()-10,top:$(window).height()-this.values.$elm.outerHeight()-10};return $last_box.length&&$last_box[0]!==this.values.$elm[0]&&(coords.top=$last_box.position().top-this.values.$elm.outerHeight()-5),this.set({coords:coords}),this}show(){var existing_boxes=alert_boxes[this.getBoxType()],box_type=(existing_boxes.pop(),this.getBoxType());return existing_boxes.length&&_.each(existing_boxes,function(box){box.values.$elm.remove(),box.clean()}),alert_boxes[this.getBoxType()]=[],/error|warning/i.test(box_type)||this.adjustCoords(),super.show(),this}},APP.stack={values:{boxes:[]},resetDepth:function(depth){depth=depth||0;if(APP.stack.values.boxes.length)for(;APP.stack.values.boxes.length-depth;)APP.stack.values.boxes.pop().clean()},getBoxes:function(){return APP.stack.values.boxes},addBox:function(box){var is_added=!1;return box instanceof UTILS.Box&&!APP.stack.boxExists(box)&&(APP.stack.values.boxes.push(box),is_added=!0),is_added},boxExists:function(box){for(var b,is_found=!1,i=0;b=APP.stack.values.boxes[i];i++)if(b===box){is_found=!0;break}return is_found},removeBox:function(box){for(var b,is_removed=!1,i=0;b=APP.stack.values.boxes[i];i++)if(b===box){APP.stack.values.boxes.splice(i,1),is_removed=!0;break}return is_removed},blurLastBox:function(box){const last_box=APP.stack.getLastBox(box);last_box?last_box.blur():box.set({dimmer:!0})},unblurLastBox:function(box){const last_box=APP.stack.getLastBox(box);last_box&&last_box.unblur()},getLastBox:function(box){var last_box=APP.stack.values.boxes.last();if(box===last_box){for(var b,is_found=!1,i=APP.stack.values.boxes.length;b=APP.stack.values.boxes[i-1];i--)if(b!==box){last_box=b,is_found=!0;break}is_found||(last_box=null)}return last_box}};